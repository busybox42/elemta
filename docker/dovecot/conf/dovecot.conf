# Dovecot configuration for Elemta testing
# Basic configuration to enable round-trip email testing

# Protocols we want to be serving
protocols = imap lmtp

# Listen on all interfaces
listen = *

# Disable SSL for testing (we're in a Docker environment)
ssl = no

# Authentication for IMAP users
auth_mechanisms = plain login
disable_plaintext_auth = no

# Mail location - store mail in /var/mail/%u
mail_location = maildir:/var/mail/%u

# Allow docker container IPs
service lmtp {
  inet_listener lmtp {
    address = 0.0.0.0
    port = 24
  }
}

service imap {
  inet_listener imap {
    address = 0.0.0.0
    port = 143
  }
}

# Create a test user
passdb {
  driver = passwd-file
  args = /etc/dovecot/passwd
}

userdb {
  driver = passwd-file
  args = /etc/dovecot/passwd
  default_fields = uid=vmail gid=vmail home=/var/mail/%u
}

# Allow any host to deliver mail via LMTP
service lmtp {
  inet_listener lmtp {
    address = 0.0.0.0
    port = 24
  }
  user = vmail
}

# Log everything for debugging
log_path = /var/log/dovecot.log
info_log_path = /var/log/dovecot-info.log
debug_log_path = /var/log/dovecot-debug.log
mail_debug = yes
auth_debug = yes
verbose_ssl = yes 